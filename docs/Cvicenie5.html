<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Cvičenie 5 - Sezónne modely, modelovanie trendu</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Časové rady</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Cvicenie1.html">Tutorial 1</a>
    </li>
    <li>
      <a href="Cvicenie2.html">Tutorial 2</a>
    </li>
    <li>
      <a href="Cvicenie3.html">Tutorial 3</a>
    </li>
    <li>
      <a href="Cvicenie4.html">Tutorial 4</a>
    </li>
    <li>
      <a href="Cvicenie5.html">Tutorial 5</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Homeworks
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Domaca_uloha1.html">Homework 1</a>
    </li>
    <li>
      <a href="Domaca_uloha2.html">Homework 2</a>
    </li>
    <li>
      <a href="Domaca_uloha3.html">Homework 3</a>
    </li>
    <li>
      <a href="Domaca_uloha4.html">Homework 4</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Cvičenie 5 - Sezónne modely, modelovanie trendu</h1>

</div>


<div id="potrebne-knižnice-pre-cvičenie-5" class="section level1">
<h1><span class="header-section-number">1</span> Potrebne knižnice pre cvičenie 5</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(fpp3) <span class="co"># data  </span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(fpp2) <span class="co"># data  </span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(ggplot2)  <span class="co"># pekne grafy</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(astsa)  <span class="co"># sarima funkcia  </span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">library</span>(urca) <span class="co"># jednotkovy koren</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">library</span>(forecast) <span class="co"># data </span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">library</span>(lubridate) <span class="co"># manipulacia casu</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">library</span>(WDI)  <span class="co"># HDP krajin</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">library</span>(mFilter)  <span class="co"># HP filter</span></a></code></pre></div>
</div>
<div id="zostavenie-sezónnych-arima-modelov" class="section level1">
<h1><span class="header-section-number">2</span> Zostavenie sezónnych ARIMA modelov</h1>
<div id="dáta" class="section level2">
<h2><span class="header-section-number">2.1</span> Dáta</h2>
<p>Budeme pracovať s údajmi o zamestnanosti pre USA. Konkrétne budeme pracovať s niektorými podsektormi služieb a cestovného ruchu. V datasete <code>us_employment</code> nájdete okrem týchto dát aj mnoho ďaľších, týkajúcich sa zamestnanosti v jednotlivých sektorov po mesiacoch.<br />
<br />
Načítame si dáta do premennej <code>leisure</code> a vytvoríme z nej object <code>ts</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">leisure &lt;-<span class="st"> </span>us_employment <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Title <span class="op">==</span><span class="st"> &quot;Leisure and Hospitality&quot;</span>,</a>
<a class="sourceLine" id="cb2-3" title="3">         <span class="kw">year</span>(Month) <span class="op">&gt;</span><span class="st"> </span><span class="dv">2000</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Employed =</span> Employed<span class="op">/</span><span class="dv">1000</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="st">  </span><span class="kw">select</span>(Month, Employed)</a>
<a class="sourceLine" id="cb2-6" title="6"></a>
<a class="sourceLine" id="cb2-7" title="7">leisure &lt;-<span class="st"> </span><span class="kw">ts</span>(leisure<span class="op">$</span>Employed, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">2001</span>,<span class="dv">1</span>), <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">2019</span>,<span class="dv">9</span>),</a>
<a class="sourceLine" id="cb2-8" title="8">              <span class="dt">frequency =</span> <span class="dv">12</span>)</a></code></pre></div>
<p>Vykreslimíme si dáta.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">autoplot</span>(leisure) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;US employment: leisure and hospitality&quot;</span>,</a>
<a class="sourceLine" id="cb3-3" title="3">       <span class="dt">y=</span><span class="st">&quot;Number of people (millions)&quot;</span>)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Dáta sa nevyznačújú rastúcou disperziou, ako je vidno na grafe, preto nebude treba pracovať s ich logaritmami.  Z dát si vynecháme poslednych 12 hodnôt, ktoré využijeme pri zhodnotení predikcií.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># odlozime si posledny rok dat na zhodnotenie predikcii</span></a>
<a class="sourceLine" id="cb4-2" title="2">leisure.pred &lt;-<span class="st"> </span><span class="kw">window</span>(leisure, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">2018</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co"># budeme pracovat s kratsim casovym radom</span></a>
<a class="sourceLine" id="cb4-5" title="5">leisure &lt;-<span class="st"> </span><span class="kw">window</span>(leisure, <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">2018</span>,<span class="dv">9</span>))</a></code></pre></div>
<p>Vykreslíme si iba tie údaja, s ktorými budeme pracovať priamo.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">autoplot</span>(leisure) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;US employment: leisure and hospitality&quot;</span>,</a>
<a class="sourceLine" id="cb5-3" title="3">       <span class="dt">y=</span><span class="st">&quot;Number of people (millions)&quot;</span>)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="zostavenie-a-vyhodnotenie-sarima-modelu" class="section level2">
<h2><span class="header-section-number">2.2</span> Zostavenie a vyhodnotenie SARIMA modelu</h2>
<p>Vykreslíme si ACF a PACF pre naše dáta.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">acf2</span>(leisure)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre><code>##      [,1]  [,2]  [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
## ACF  0.97  0.91  0.83 0.77 0.72 0.70 0.70 0.73 0.77  0.80  0.82  0.82  0.79
## PACF 0.97 -0.38 -0.09 0.15 0.16 0.27 0.15 0.22 0.05  0.07  0.02 -0.08 -0.31
##      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]
## ACF   0.73  0.66  0.59  0.54  0.52  0.52  0.54  0.57  0.60  0.62  0.62  0.59
## PACF -0.13 -0.06 -0.03 -0.04  0.03  0.00  0.08  0.03  0.08  0.05  0.00 -0.18
##      [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37]
## ACF   0.53  0.46  0.40  0.35  0.33  0.33  0.35  0.38  0.41  0.43  0.43  0.40
## PACF -0.02  0.00 -0.03 -0.04  0.00 -0.03  0.03  0.00  0.06  0.04  0.00 -0.11
##      [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48]
## ACF   0.34  0.28  0.23  0.18  0.16  0.17  0.19  0.22  0.25  0.27  0.27
## PACF  0.02  0.03 -0.01 -0.04  0.00 -0.03  0.01  0.01  0.04  0.03 -0.01</code></pre>
<p>V dátach je viditeľný trend, rovnako ako pravideľná sezónnosť. Dáta preto bude nutné diferencovať. Keďže ale pracujeme so sezónnymi dátami, má zmysel spraviť ako prvé sezónne diferencie (môže ísť napríklad o sezónnosť v strednej hodnote) a zhodnotíme, či v dátach ešte ostal trend, a či treba dáta ešte diferencovať obyčajne.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">leisure.d12 &lt;-<span class="st"> </span><span class="kw">diff</span>(leisure, <span class="dt">lag =</span> <span class="dv">12</span>)</a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">autoplot</span>(leisure.d12) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Seasonally differenced - US employment: leisure and hospitality&quot;</span>,</a>
<a class="sourceLine" id="cb9-3" title="3">       <span class="dt">y=</span><span class="st">&quot;Number of people (millions)&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;green&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(leisure.d12), <span class="dt">color =</span> <span class="st">&quot;orange&quot;</span>)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">acf2</span>(leisure.d12)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6] [,7]  [,8] [,9] [,10] [,11] [,12] [,13]
## ACF  0.98  0.96  0.93  0.90  0.86  0.82 0.78  0.74 0.70  0.66  0.61  0.57  0.53
## PACF 0.98 -0.19 -0.18 -0.04 -0.07 -0.10 0.01 -0.03 0.02 -0.02 -0.07 -0.20  0.26
##      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]
## ACF   0.48  0.44  0.39  0.35  0.31  0.26  0.22  0.18  0.14  0.10  0.07  0.04
## PACF -0.13 -0.07 -0.02 -0.09  0.05  0.00 -0.08  0.03  0.03  0.09 -0.02  0.06
##      [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37]
## ACF   0.02  0.00 -0.02 -0.03 -0.05 -0.06 -0.08 -0.09 -0.11 -0.12 -0.14 -0.15
## PACF  0.03  0.02  0.03 -0.06 -0.04 -0.06 -0.05 -0.10  0.02  0.02  0.02  0.09
##      [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48]
## ACF  -0.16 -0.17 -0.18 -0.19 -0.19 -0.20 -0.21 -0.21 -0.22 -0.23 -0.24
## PACF -0.10 -0.06  0.06 -0.09  0.05 -0.08  0.00  0.02 -0.08  0.02 -0.02</code></pre>
<p>V dátach nie je vidno značný trend, preto ich z tohto dôvodu nebude treba diferencovať. Čo ale treba ešte overiť, je prítomnosť jednotkového koreňa, ktorý by mohol spôsobovať nestacionaritu časového radu. Podľa grafu je zjavné, že priemer dát je výrazne vzdialený od 0, aj keď jeho dhonota je len niečo málo okolo 0.25, vždy treba zobrať do úvahy aj rozptyl dát. Preto, použijeme v funkcii <code>ur.df</code> parameter <code>type = "drift"</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># ostesujeme pritomnost jednotkoveho korena jednotkovy koren</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">summary</span>(<span class="kw">ur.df</span>(leisure.d12, <span class="dt">lags =</span> <span class="dv">5</span>, <span class="dt">selectlags =</span> <span class="st">&quot;BIC&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;drift&quot;</span>))</a></code></pre></div>
<pre><code>## 
## ############################################### 
## # Augmented Dickey-Fuller Test Unit Root Test # 
## ############################################### 
## 
## Test regression drift 
## 
## 
## Call:
## lm(formula = z.diff ~ z.lag.1 + 1 + z.diff.lag)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.126004 -0.028521 -0.000713  0.029430  0.110352 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  0.009634   0.004240   2.272   0.0242 *
## z.lag.1     -0.028866   0.012089  -2.388   0.0179 *
## z.diff.lag1  0.128525   0.069937   1.838   0.0677 .
## z.diff.lag2  0.177001   0.069943   2.531   0.0122 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03987 on 191 degrees of freedom
## Multiple R-squared:  0.07702,    Adjusted R-squared:  0.06252 
## F-statistic: 5.313 on 3 and 191 DF,  p-value: 0.001542
## 
## 
## Value of test-statistic is: -2.3877 3.1362 
## 
## Critical values for test statistics: 
##       1pct  5pct 10pct
## tau2 -3.46 -2.88 -2.57
## phi1  6.52  4.63  3.81</code></pre>
<p>Vidíme, že test pre naše dáta nezamietol hypotézu o jednotkovom koreni, preto dáta budeme diferencovať.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">leisure.d12.d1 &lt;-<span class="st"> </span><span class="kw">diff</span>(leisure.d12)</a></code></pre></div>
<p>Zdiferencované dáta znova otestujeme na prítomnosť jednotkového koreňa. V tomto prípade je priemer dát veľmi blízky 0 (aj vzhľadom na disperziu dát), preto použijeme <code>type = "none"</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">autoplot</span>(leisure.d12.d1) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Seasonally and first differenced - US employment: leisure and hospitality&quot;</span>,</a>
<a class="sourceLine" id="cb15-3" title="3">       <span class="dt">y=</span><span class="st">&quot;Number of people (millions)&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;green&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(leisure.d12.d1), <span class="dt">color =</span> <span class="st">&quot;orange&quot;</span>)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>V dátach nie je vidno ani trend, ani pravideľná sezónnosť, čo si vieme overiť aj pomocou ACF.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">acf2</span>(leisure.d12.d1)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre><code>##      [,1] [,2]  [,3] [,4] [,5]  [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
## ACF  0.16 0.22  0.03 0.09 0.09  0.01 0.07 0.02 0.08  0.09  0.18 -0.19  0.02
## PACF 0.16 0.20 -0.03 0.05 0.08 -0.04 0.04 0.02 0.04  0.07  0.15 -0.30  0.03
##      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]
## ACF  -0.02  0.05  0.07 -0.06  0.02 -0.04 -0.05 -0.07 -0.15 -0.14 -0.09 -0.13
## PACF  0.07 -0.01  0.07 -0.06 -0.04  0.01 -0.08 -0.08 -0.09 -0.01 -0.10 -0.08
##      [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37]
## ACF  -0.06 -0.09 -0.07  0.00  0.00  0.00  0.07 -0.06  0.00 -0.07 -0.13  0.02
## PACF  0.00 -0.03  0.03  0.03  0.05  0.03  0.13 -0.06 -0.06  0.00 -0.14  0.07
##      [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48]
## ACF  -0.05  0.02  0.00 -0.06  0.05 -0.01 -0.09  0.05 -0.03  0.01  0.01
## PACF  0.04 -0.05  0.02 -0.08  0.05 -0.02 -0.10  0.07 -0.03 -0.06 -0.08</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">summary</span>(<span class="kw">ur.df</span>(leisure.d12.d1, <span class="dt">lags =</span> <span class="dv">5</span>, <span class="dt">selectlags =</span> <span class="st">&quot;BIC&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;none&quot;</span>))</a></code></pre></div>
<pre><code>## 
## ############################################### 
## # Augmented Dickey-Fuller Test Unit Root Test # 
## ############################################### 
## 
## Test regression none 
## 
## 
## Call:
## lm(formula = z.diff ~ z.lag.1 - 1 + z.diff.lag)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.128395 -0.026060  0.002863  0.031670  0.122542 
## 
## Coefficients:
##            Estimate Std. Error t value Pr(&gt;|t|)    
## z.lag.1    -0.70353    0.09239  -7.615 1.17e-12 ***
## z.diff.lag -0.16797    0.07069  -2.376   0.0185 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0404 on 192 degrees of freedom
## Multiple R-squared:  0.4386, Adjusted R-squared:  0.4327 
## F-statistic:    75 on 2 and 192 DF,  p-value: &lt; 2.2e-16
## 
## 
## Value of test-statistic is: -7.6149 
## 
## Critical values for test statistics: 
##       1pct  5pct 10pct
## tau1 -2.58 -1.95 -1.62</code></pre>
<p>Test nám hypotézu o jednotkovom koreni zamietol, dáta preto už nebudeme viacej diferencovať.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">autoplot</span>(leisure.d12.d1) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Seasonally and first differenced - US employment: leisure and hospitality&quot;</span>,</a>
<a class="sourceLine" id="cb20-3" title="3">       <span class="dt">y=</span><span class="st">&quot;Number of people (millions)&quot;</span>)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Vykreslíme si ACF a PACF pre naše dva krát zdiferencované dáta (raz sezónne a raz obyčajne). Na dobrý tip pre nesezónne časti sarima modelu nám poslúžia prvé lagy ACF a PACF, na spravenie tipu pre sezónne časti sarima modelu zase hodnoty ACF a PACF v lagoch 1,2,3,4,… (teda každá 12,24,36 hodnota, podľa našej sezónnosti, keďže pracujeme s mesačnými dátami, a zaujíma nás ročná sezónnosť).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">acf2</span>(leisure.d12.d1)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre><code>##      [,1] [,2]  [,3] [,4] [,5]  [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
## ACF  0.16 0.22  0.03 0.09 0.09  0.01 0.07 0.02 0.08  0.09  0.18 -0.19  0.02
## PACF 0.16 0.20 -0.03 0.05 0.08 -0.04 0.04 0.02 0.04  0.07  0.15 -0.30  0.03
##      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]
## ACF  -0.02  0.05  0.07 -0.06  0.02 -0.04 -0.05 -0.07 -0.15 -0.14 -0.09 -0.13
## PACF  0.07 -0.01  0.07 -0.06 -0.04  0.01 -0.08 -0.08 -0.09 -0.01 -0.10 -0.08
##      [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37]
## ACF  -0.06 -0.09 -0.07  0.00  0.00  0.00  0.07 -0.06  0.00 -0.07 -0.13  0.02
## PACF  0.00 -0.03  0.03  0.03  0.05  0.03  0.13 -0.06 -0.06  0.00 -0.14  0.07
##      [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48]
## ACF  -0.05  0.02  0.00 -0.06  0.05 -0.01 -0.09  0.05 -0.03  0.01  0.01
## PACF  0.04 -0.05  0.02 -0.08  0.05 -0.02 -0.10  0.07 -0.03 -0.06 -0.08</code></pre>
<p>Dobrý tip by mohol byť napríklad AR(2), poprípade MA(2) pre nesezónnu časť a sMA(1), sAR(1) pre sezónnu časť. Vyskúšame aj iné modely, resp. rôzne kombinácie našich tipov.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">model.y &lt;-<span class="st"> </span><span class="kw">capture.output</span>(<span class="kw">sarima</span>(leisure, <span class="dv">2</span> ,<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">12</span>))</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">model.y &lt;-<span class="st"> </span><span class="kw">capture.output</span>(<span class="kw">sarima</span>(leisure, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">12</span>)) <span class="co"># zle rezidua</span></a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-18-2.png" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">model.y &lt;-<span class="st"> </span><span class="kw">capture.output</span>(<span class="kw">sarima</span>(leisure, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">12</span>))</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-18-3.png" width="672" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">model.y &lt;-<span class="st"> </span><span class="kw">capture.output</span>(<span class="kw">sarima</span>(leisure, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">12</span>)) <span class="co"># zle rezidua</span></a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-18-4.png" width="672" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">model.y &lt;-<span class="st"> </span><span class="kw">capture.output</span>(<span class="kw">sarima</span>(leisure, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">12</span>)) <span class="co"># zle rezidua</span></a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-18-5.png" width="672" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">model.y &lt;-<span class="st"> </span><span class="kw">capture.output</span>(<span class="kw">sarima</span>(leisure, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">12</span>))</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-18-6.png" width="672" /></p>
<p>Vidíme, že nie všetky mali dobré rezídua, Ljung-Boxov test bol pod 5% pre určité lagy. Z tých, ktorým vyšli rezídua dobre vyberieme finálny model na základe BIC.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">sarima</span>(leisure, <span class="dv">2</span> ,<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">12</span>, <span class="dt">details =</span> <span class="ot">FALSE</span>)<span class="op">$</span>BIC</a></code></pre></div>
<pre><code>## [1] -3.368345</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">sarima</span>(leisure, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">12</span>, <span class="dt">details =</span> <span class="ot">FALSE</span>)<span class="op">$</span>BIC</a></code></pre></div>
<pre><code>## [1] -3.397317</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">sarima</span>(leisure, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">12</span>, <span class="dt">details =</span> <span class="ot">FALSE</span>)<span class="op">$</span>BIC</a></code></pre></div>
<pre><code>## [1] -3.388213</code></pre>
<p>Najmenšie BIC má model (2,1,0)x(0,1,1). Tento použijeme na predikcie naších dát.</p>
</div>
<div id="predikcie-pre-sarima-model" class="section level2">
<h2><span class="header-section-number">2.3</span> Predikcie pre SARIMA model</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co"># forecast</span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="kw">sarima.for</span>(leisure,<span class="dv">12</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">12</span>)</a></code></pre></div>
<pre><code>## $pred
##           Jan      Feb      Mar      Apr      May      Jun      Jul      Aug
## 2018                                                                        
## 2019 15.74516 15.89366 16.12967 16.46041 16.86718 17.34813 17.46203 17.39826
##           Sep      Oct      Nov      Dec
## 2018          16.38222 16.16967 16.13635
## 2019 16.86376                           
## 
## $se
##             Jan        Feb        Mar        Apr        May        Jun
## 2018                                                                  
## 2019 0.10022511 0.11754861 0.13322359 0.14758400 0.16083531 0.17316863
##             Jul        Aug        Sep        Oct        Nov        Dec
## 2018                                  0.03796299 0.05951616 0.08118589
## 2019 0.18472873 0.19563335 0.20597558</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">points</span>(leisure.pred, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="ďalšie-dáta-na-precvičenie" class="section level2">
<h2><span class="header-section-number">2.4</span> Ďalšie dáta na precvičenie</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">autoplot</span>(hsales) <span class="op">+</span></a>
<a class="sourceLine" id="cb38-2" title="2"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Monthly sales of new one-family houses sold in the USA since 1973&quot;</span>,</a>
<a class="sourceLine" id="cb38-3" title="3">       <span class="dt">y=</span><span class="st">&quot;&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">autoplot</span>(auscafe) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;The total monthly expenditure on services in Australia&quot;</span>,</a>
<a class="sourceLine" id="cb39-3" title="3">       <span class="dt">y=</span><span class="st">&quot;&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">autoplot</span>(qcement) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Total quarterly production of Portland cement in Australia&quot;</span>,</a>
<a class="sourceLine" id="cb40-3" title="3">       <span class="dt">y=</span><span class="st">&quot;&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
</div>
<div id="modelovanie-trendu" class="section level1">
<h1><span class="header-section-number">3</span> Modelovanie trendu</h1>
<div id="exponenciálne-zhladzovanie" class="section level2">
<h2><span class="header-section-number">3.1</span> Exponenciálne zhladzovanie</h2>
<p>Budeme modelovať dáta bez trendu. Konkrétne dáta <code>BJsales</code>, respektíve ich prvé diferencie.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">y &lt;-<span class="st"> </span>BJsales</a>
<a class="sourceLine" id="cb41-2" title="2">y.d1 &lt;-<span class="st"> </span><span class="kw">diff</span>(y)</a>
<a class="sourceLine" id="cb41-3" title="3"></a>
<a class="sourceLine" id="cb41-4" title="4"><span class="co"># nechame si poslednych 20 na zhodnotenie predikcii</span></a>
<a class="sourceLine" id="cb41-5" title="5">y.d1.pred &lt;-<span class="st"> </span><span class="kw">window</span>(y.d1, <span class="dt">start =</span> <span class="dv">131</span>)</a>
<a class="sourceLine" id="cb41-6" title="6">y.d1 &lt;-<span class="st"> </span><span class="kw">window</span>(y.d1, <span class="dt">end =</span> <span class="dv">130</span>)</a>
<a class="sourceLine" id="cb41-7" title="7"></a>
<a class="sourceLine" id="cb41-8" title="8"><span class="kw">autoplot</span>(y.d1)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>Exponenciálne zhladzovanie je špeciálny prípad Holt-wintersovej metódy, ak vynecháme parametre <code>beta</code> a <code>gamma</code>. Použijeme funkciu HoltWintgers v tvare:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">HoltWinters</span>(data,<span class="dt">beta =</span> <span class="ot">FALSE</span>, <span class="dt">gamma =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Predikcie pre Holt-wintersa dostaneme použitím funkcie <code>predict</code>. Jednotlivé parametre: <code>object</code> je náš odhadnutý model, teda uložený výstup funckie <code>HoltWinters</code>, n.ahead predstavuje na koľko pozorovaní dopredu chceme určiť predikcie, level určuje hladinu významnosti, teda aké intervaly spoľahlivosti chceme vykresliť/vypočítať, prediction.interval označuje, či chceme alebo nie počítať Intervaly spolahlivosti.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">predict</span>(object , n.ahead , prediction.interval,</a>
<a class="sourceLine" id="cb43-2" title="2">       level , ...)</a></code></pre></div>
<p>Každý samostnatne si spusti metódu pre dáta. Vykreslite pôvodné dáta a predikcie doporedu pre 10 časových jednotiek do budúcnosti.</p>
<p>Na vykreslenie môžete použiť predpripravenú funkciu:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">pallete &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="st">&quot;#D55E00&quot;</span>,<span class="st">&quot;#009E73&quot;</span>,<span class="st">&quot;#009E73&quot;</span>, <span class="st">&quot;gray&quot;</span>, <span class="st">&quot;gray&quot;</span>)</a>
<a class="sourceLine" id="cb44-2" title="2">pred.is &lt;-<span class="st"> </span>pred <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tsibble</span>(<span class="dt">pivot_longer =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb44-3" title="3"></a>
<a class="sourceLine" id="cb44-4" title="4"><span class="kw">autoplot</span>(y.d1) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-5" title="5"><span class="st">  </span><span class="kw">autolayer</span>(exp.y.d1<span class="op">$</span>fitted[,<span class="st">&quot;xhat&quot;</span>], <span class="dt">series=</span><span class="st">&quot;Fitted data&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-6" title="6"><span class="st">  </span><span class="kw">autolayer</span>(y.d1.pred, <span class="dt">series=</span><span class="st">&quot;Data&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-7" title="7"><span class="st">  </span><span class="kw">autolayer</span>(pred[,<span class="st">&quot;fit&quot;</span>], <span class="dt">series=</span><span class="st">&quot;Forecasts&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb44-8" title="8"><span class="st">  </span><span class="kw">autolayer</span>(pred[,<span class="st">&quot;upr&quot;</span>], <span class="dt">series=</span><span class="st">&quot;UB&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb44-9" title="9"><span class="st">  </span><span class="kw">autolayer</span>(pred[,<span class="st">&quot;lwr&quot;</span>], <span class="dt">series=</span><span class="st">&quot;LB&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb44-10" title="10"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> pred.is, <span class="kw">aes</span>(<span class="dt">x =</span> index,<span class="dt">y =</span> fit, <span class="dt">ymin =</span> lwr, <span class="dt">ymax =</span> upr, <span class="dt">fill =</span> <span class="st">&quot;0.95% IS&quot;</span>),  <span class="dt">alpha =</span> <span class="fl">0.2</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb44-11" title="11"><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values=</span>pallete)<span class="op">+</span></a>
<a class="sourceLine" id="cb44-12" title="12"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="st">&quot;gray&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb44-13" title="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="holt-wintersová-metóda" class="section level2">
<h2><span class="header-section-number">3.2</span> Holt-Wintersová metóda</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="kw">HoltWinters</span>(data,<span class="dt">alpha =</span> <span class="ot">FALSE</span> ,<span class="dt">beta =</span> <span class="ot">FALSE</span>, <span class="dt">gamma =</span> <span class="ot">FALSE</span>, <span class="dt">seasonal =</span> <span class="kw">c</span>(<span class="st">&quot;multiplicative&quot;</span>,<span class="st">&quot;additive&quot;</span>))</a></code></pre></div>
<p>Ak sa v dátach nachádza lineárny trend a chcemeho zahrnúť do modelu, exponenciálne zhladzovanie nemusí byť dostatočné. Preto použijeme Holt-Wintersovú metódu. Oproti predchádzajúcemu príkladu sa líši o to, že sa odhane aj parametere <code>beta</code>. Odhadnite pre dáta (nie diferencie) Holt-Wintersov model a rovnako spravte aj predickie na 10 časových jednotiek do budúcna.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">y &lt;-<span class="st"> </span>BJsales</a>
<a class="sourceLine" id="cb46-2" title="2"></a>
<a class="sourceLine" id="cb46-3" title="3"><span class="co"># nechame si poslednych 20 na zhodnotenie predikcii</span></a>
<a class="sourceLine" id="cb46-4" title="4">y.pred &lt;-<span class="st"> </span><span class="kw">window</span>(y, <span class="dt">start =</span> <span class="dv">131</span>)</a>
<a class="sourceLine" id="cb46-5" title="5">y &lt;-<span class="st"> </span><span class="kw">window</span>(y, <span class="dt">end =</span> <span class="dv">130</span>)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="holt-wintersová-metóda-multiplikatívna-vs-aditívna-sezonalita" class="section level2">
<h2><span class="header-section-number">3.3</span> Holt-Wintersová metóda Multiplikatívna vs Aditívna sezonalita</h2>
<p>Majme sezónne dáta z prvej časti cvičení, obe sú mesačné dáta</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="co"># data </span></a>
<a class="sourceLine" id="cb47-2" title="2">leisure &lt;-<span class="st"> </span>us_employment <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-3" title="3"><span class="st">  </span><span class="kw">filter</span>(Title <span class="op">==</span><span class="st"> &quot;Leisure and Hospitality&quot;</span>,</a>
<a class="sourceLine" id="cb47-4" title="4">         <span class="kw">year</span>(Month) <span class="op">&gt;</span><span class="st"> </span><span class="dv">2000</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Employed =</span> Employed<span class="op">/</span><span class="dv">1000</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-6" title="6"><span class="st">  </span><span class="kw">select</span>(Month, Employed)</a>
<a class="sourceLine" id="cb47-7" title="7"></a>
<a class="sourceLine" id="cb47-8" title="8">leisure &lt;-<span class="st"> </span><span class="kw">ts</span>(leisure<span class="op">$</span>Employed, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">2001</span>,<span class="dv">1</span>), <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">2019</span>,<span class="dv">9</span>),</a>
<a class="sourceLine" id="cb47-9" title="9">              <span class="dt">frequency =</span> <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb47-10" title="10"></a>
<a class="sourceLine" id="cb47-11" title="11"><span class="co"># odlozime si posledny rok dat na zhodnotenie predikcii</span></a>
<a class="sourceLine" id="cb47-12" title="12">leisure.pred &lt;-<span class="st"> </span><span class="kw">window</span>(leisure, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">2017</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb47-13" title="13"></a>
<a class="sourceLine" id="cb47-14" title="14"><span class="co"># budeme pracovat s kratsim casovym radom</span></a>
<a class="sourceLine" id="cb47-15" title="15">leisure &lt;-<span class="st"> </span><span class="kw">window</span>(leisure, <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">2017</span>,<span class="dv">9</span>))</a>
<a class="sourceLine" id="cb47-16" title="16"></a>
<a class="sourceLine" id="cb47-17" title="17"><span class="kw">autoplot</span>(leisure) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-18" title="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;US employment: leisure and hospitality&quot;</span>,</a>
<a class="sourceLine" id="cb47-19" title="19">       <span class="dt">y=</span><span class="st">&quot;Number of people (millions)&quot;</span>)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">auscafe.pred &lt;-<span class="st"> </span><span class="kw">window</span>(auscafe, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">2015</span>, <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb48-2" title="2">auscafe.ts &lt;-<span class="st"> </span><span class="kw">window</span>(auscafe, <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">2015</span>, <span class="dv">9</span>))</a>
<a class="sourceLine" id="cb48-3" title="3"><span class="kw">autoplot</span>(auscafe.ts) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;The total monthly expenditure on services in Australia&quot;</span>,</a>
<a class="sourceLine" id="cb48-5" title="5">       <span class="dt">y=</span><span class="st">&quot;&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>Pre obe dáta modelujte Holt-wintersovou metódou trend, spravte predikcie na 2 roky dopredu, t.j. 24 mesiacov/pozorovaní dopredu.</p>
<p>Pre <code>leisure</code> dáta: <img src="Cvicenie5_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>Pre <code>auscafe</code> dáta: <img src="Cvicenie5_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
</div>
</div>
<div id="hodrick-prescottov-filter" class="section level1">
<h1><span class="header-section-number">4</span> Hodrick-Prescottov filter</h1>
<p>Využitie na dáta bez sezónnej zložky na odhadovanie trendu. Aplikujeme na výpočet produkčnej medzery, analogicky podľa posledných slajdov na prednáške. <a href="http://www.iam.fmph.uniba.sk/institute/stehlikova/cr21/cr08.pdf" class="uri">http://www.iam.fmph.uniba.sk/institute/stehlikova/cr21/cr08.pdf</a></p>
<p>2 parametre, <code>data</code>, <code>freq</code> == lambda v prednáškach. Odhadnutý trend je potom uložený v <code>hp$trend</code>. Odporúčané hodnoty pre lambdu, reps. parameter <code>freq</code>:<br />
* 100 pre ročné dáta * 1600 pre kvartálne dáta * 14400 pre mesačné dáta</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">hp &lt;-<span class="st"> </span><span class="kw">hpfilter</span>(data, <span class="dt">freq =</span> <span class="dv">100</span>) </a></code></pre></div>
<div id="aplikácia-pri-výpočte-produkčnej-medzery" class="section level2">
<h2><span class="header-section-number">4.1</span> Aplikácia pri výpočte produkčnej medzery</h2>
<p>Opakovanie prednášky:<br />
</p>
<ul>
<li>Potenciálne HDP - Maximálny výstup, ktorý vie ekonomika pri daných faktoroch vyprodukovať bez inflačných tlakov</li>
<li>Skutočná hodnota HDP osciluje okolo potenciálneho HDP (hospodárske cykly)</li>
<li>Produkčná medzera - rozdiel medzi potenciálnym a reálnym HDP výstupom</li>
</ul>
<div id="dáta-1" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Dáta</h3>
<p>Nemecko</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">data &lt;-<span class="st"> </span><span class="kw">WDI</span>(<span class="dt">indicator =</span> <span class="st">&#39;NY.GNP.PCAP.KD&#39;</span>,</a>
<a class="sourceLine" id="cb50-2" title="2">            <span class="dt">country=</span> <span class="kw">c</span> (<span class="st">&#39;DE&#39;</span>),</a>
<a class="sourceLine" id="cb50-3" title="3">            <span class="dt">start =</span> <span class="dv">1975</span>, <span class="dt">end =</span> <span class="dv">2019</span>)</a>
<a class="sourceLine" id="cb50-4" title="4"></a>
<a class="sourceLine" id="cb50-5" title="5">data &lt;-<span class="st"> </span>data[<span class="kw">order</span>(data<span class="op">$</span>year),]</a>
<a class="sourceLine" id="cb50-6" title="6"></a>
<a class="sourceLine" id="cb50-7" title="7">y_DE &lt;-<span class="st"> </span><span class="kw">ts</span>(data<span class="op">$</span>NY.GNP.PCAP.KD, <span class="dt">start =</span> <span class="dv">1975</span>, <span class="dt">frequency =</span> <span class="dv">1</span>)</a></code></pre></div>
<p>Rakúsko</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">data &lt;-<span class="st"> </span><span class="kw">WDI</span>(<span class="dt">indicator =</span> <span class="st">&#39;NY.GNP.PCAP.KD&#39;</span>,</a>
<a class="sourceLine" id="cb51-2" title="2">            <span class="dt">country=</span> <span class="kw">c</span> (<span class="st">&#39;AT&#39;</span>),</a>
<a class="sourceLine" id="cb51-3" title="3">            <span class="dt">start =</span> <span class="dv">1975</span>, <span class="dt">end =</span> <span class="dv">2019</span>)</a>
<a class="sourceLine" id="cb51-4" title="4">data &lt;-<span class="st"> </span>data[<span class="kw">order</span>(data<span class="op">$</span>year),]</a>
<a class="sourceLine" id="cb51-5" title="5">y_AT &lt;-<span class="st"> </span><span class="kw">ts</span>(data<span class="op">$</span>NY.GNP.PCAP.KD, <span class="dt">start =</span> <span class="dv">1975</span>, <span class="dt">frequency =</span> <span class="dv">1</span>)</a></code></pre></div>
<p>USA</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">data &lt;-<span class="st"> </span><span class="kw">WDI</span>(<span class="dt">indicator =</span> <span class="st">&#39;NY.GNP.PCAP.KD&#39;</span>,</a>
<a class="sourceLine" id="cb52-2" title="2">            <span class="dt">country=</span> <span class="kw">c</span> (<span class="st">&#39;US&#39;</span>),</a>
<a class="sourceLine" id="cb52-3" title="3">            <span class="dt">start =</span> <span class="dv">1975</span>, <span class="dt">end =</span> <span class="dv">2019</span>)</a>
<a class="sourceLine" id="cb52-4" title="4">data &lt;-<span class="st"> </span>data[<span class="kw">order</span>(data<span class="op">$</span>year),]</a>
<a class="sourceLine" id="cb52-5" title="5">y_US &lt;-<span class="st"> </span><span class="kw">ts</span>(data<span class="op">$</span>NY.GNP.PCAP.KD, <span class="dt">start =</span> <span class="dv">1975</span>, <span class="dt">frequency =</span> <span class="dv">1</span>)</a></code></pre></div>
</div>
<div id="zadanie" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Zadanie</h3>
<p>Pre každú z krajín (môžete si zvoliť aj inú) vypočítajte produkčnú medzeru ako relatívnu zmenu potenciálneho HDP oproti skutočnému. <span class="math display">\[100(\frac{HDP-HDP_{pot}}{HDP_{pot}})\]</span></p>
<p>Vykreslite do jedného grafu hodnoty potenciálneho HDP aj hodnoty skutočného HDP.</p>
<p><img src="Cvicenie5_files/figure-html/unnamed-chunk-41-1.png" width="672" /><img src="Cvicenie5_files/figure-html/unnamed-chunk-41-2.png" width="672" /><img src="Cvicenie5_files/figure-html/unnamed-chunk-41-3.png" width="672" /><img src="Cvicenie5_files/figure-html/unnamed-chunk-41-4.png" width="672" /><img src="Cvicenie5_files/figure-html/unnamed-chunk-41-5.png" width="672" /><img src="Cvicenie5_files/figure-html/unnamed-chunk-41-6.png" width="672" /></p>
<pre><code>##           DE$pm     AT$pm     US$pm
## DE$pm 1.0000000 0.7133670 0.3862262
## AT$pm 0.7133670 1.0000000 0.3706671
## US$pm 0.3862262 0.3706671 1.0000000</code></pre>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
